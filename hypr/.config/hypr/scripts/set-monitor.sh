#!/bin/bash

# Wait for monitors to be detected (max 10 seconds)                                                                                                   │
# This prevents empty configuration if hyprctl isn't ready immediately                                                                                │
sleep 0.5
for i in {1..20}; do
    if hyprctl monitors | grep -q "Monitor"; then
        break
    fi
    sleep 0.5
done

# Initialize with defaults to avoid empty configuration
PRIMARY="preferred"
SECONDARY="preferred"

if hyprctl monitors | grep -qi "Japannext"; then
    PRIMARY="\$monitor_japannext"
elif hyprctl monitors | grep -qi "Xiaomi"; then
    PRIMARY="\$monitor_xiaomi"
fi

if hyprctl monitors | grep -qi "LG ULTRAGEAR"; then
    SECONDARY="\$monitor_lg"
elif hyprctl monitors | grep -qi "BenQ"; then
    SECONDARY="\$monitor_benq"
fi

# Write Hyprland config variables to a file
cat >~/.config/hypr/monitor-vars.conf <<EOF
# Auto-generated by set-monitor.sh
\$primary_monitor = $PRIMARY
\$secondary_monitor = $SECONDARY
EOF
